@page "/"
@model MiniCore.Pages.IndexModel
@{
    Layout = "_Layout";
    ViewData["Title"] = ".Net Minimal";
}

<div class="container" id="app">

     <h2>{{product.name}}</h1>
     <h4>A minimal reactive .net8 (razor) example</h4>
     <h6>It uses Vue3 to view some data from an sqllite database</h6>
     <h6>It defines an endpoint (handler) that are called after page load</h6>

    <img src="~/images/minicore.jpg" class="rounded m-3" width="500" >

    

    <h5>Dependencies / purpose</h5>
    <table class="table">
        <thead>
            <th>Dependency</th>
            <th>Version</th>
            <th>Purpose</th>
        </thead>
        <tbody>
            <tr  v-for="item in product.dependencies">
                <td>{{item.name}}</td>
                <td>{{item.version}}</td>
                <td>{{item.purpose}}</td>
            </tr>
        </tbody>
    </table>
   

</div>

@section Scripts
{

    <script>

       const SimpleVueApp = {
        data() {
            return {
            product:{}
            }
        },
        methods:
        {
            getProduct: function()
            {
                var context = this;
                var baseurl = '@Url.Content("~")';
                var endpointurl = baseurl + "?handler=List";
                    fetch(endpointurl)
                    .then(response => {
                        return response.json();
                     })
                     .then(product => {
                         context.product = product;
                     });
                        
            }
        },
        mounted() 
        {
            this.getProduct();
        }
    }

    Vue.createApp(SimpleVueApp).mount('#app')

    </script>

}